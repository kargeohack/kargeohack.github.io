<!doctypehtml> <html lang=en> <head> <meta charset=UTF-8> <title>paradnaya</title> <script src=https://d3js.org/d3.v7.min.js></script> <style>body,html{margin:0;padding:0;overflow:hidden;height:100%}.node circle{fill:#999;stroke-width:3px}.node.highlight circle{fill:#448AFF;stroke-width:2.5px}.link{stroke:#999;stroke-width:.2px;stroke-opacity:1}.link.highlight{stroke:#448AFF;stroke-width:1.5px}text{font-size:12px;font-family:Arial,sans-serif;text-anchor:middle;pointer-events:none}#map{width:100vw;height:100vh}.searchLine{position:absolute}</style> </head> <body> <dir class=searchLine> <input id=search placeholder="Search by username"> <button id=searchButton>Search</button> </dir> <svg id=map></svg> <script>fetch("1.min.json").then(t=>t.json()).then(t=>{let e=t.map(t=>({id:t.id,username:t.username})),r=t.flatMap(t=>t.followers.map(e=>({source:t.id,target:e.toString()})));e.forEach(t=>{let e=r.filter(e=>e.source===t.id).length,i=r.filter(e=>e.target===t.id).length;t.degree=e+i});let i=window.innerWidth,a=window.innerHeight,d=d3.select("svg"),n=d.append("g"),l=d.append("g"),s=d.append("g"),c=d3.forceSimulation(e).force("link",d3.forceLink(r).id(t=>t.id).distance(150)).force("charge",d3.forceManyBody().strength(-300)).force("center",d3.forceCenter(i/2,a/2)),o=n.selectAll(".link").data(r).enter().append("line").attr("class","link"),g=l.selectAll(".node").data(e).enter().append("g").attr("class","node").on("click",m);function h(t){g.classed("highlight",!1),o.classed("highlight",!1);let i=e.find(e=>e.username===t);i?(g.filter(t=>t.id===i.id).classed("highlight",!0),o.filter(t=>t.source.id===i.id||t.target.id===i.id).classed("highlight",!0),g.filter(t=>r.some(e=>e.source.id===i.id&&e.target.id===t.id||e.target.id===i.id&&e.source.id===t.id)).classed("highlight",!0)):alert("Node not found!")}g.append("circle").attr("r",8),document.getElementById("searchButton").addEventListener("click",()=>{let t=document.getElementById("search").value;h(t)}),g.append("circle").attr("r",t=>5+.3*t.degree);let f=s.selectAll(".text").data(e).enter().append("text").attr("class","text").text(t=>t.username);function m(t,e){o.classed("highlight",t=>t.source.id===e.id||t.target.id===e.id),g.classed("highlight",t=>t.id===e.id||r.some(r=>r.source.id===e.id&&r.target.id===t.id||r.target.id===e.id&&r.source.id===t.id))}function u(){o.classed("highlight",!1),g.classed("highlight",!1)}c.on("tick",()=>{o.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),g.attr("transform",t=>`translate(${t.x},${t.y})`),f.attr("x",t=>t.x).attr("y",t=>t.y-12)});let p=d3.zoom().scaleExtent([.5,5]).on("zoom",t=>{n.attr("transform",t.transform),l.attr("transform",t.transform),s.attr("transform",t.transform)});d.call(p)}).catch(t=>console.error(t));</script> 
